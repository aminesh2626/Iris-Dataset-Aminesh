# -*- coding: utf-8 -*-
"""iris_spark.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/13j_FmxHfBA6EQXOgWllWJBErMXKGawMX

# IRIS DATASET - CLASSIFICATION  ( DECISION TREE )

Aminesh Deshmukh

# Importing Libraries
"""

import seaborn as sns
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import io

"""# Importing dataset and data-preprocessing"""

#from google.colab import files
#uploaded = files.upload() 
df = pd.read_csv(io.BytesIO(uploaded['Iris.csv']))
df = pd.read_csv('Iris.csv')
df =df.drop(['Id'] , axis=1)
df.head()

from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
df['Species']=le.fit_transform(df['Species'])

df.columns

df.info()

df.describe()

df.corr(method ='kendall')

sns.heatmap(df.corr())



"""# Building the model"""

X= df[df.columns[0:4]]
y= df[df.columns[4:5]]

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.3)

from sklearn.tree import DecisionTreeClassifier
model = DecisionTreeClassifier(criterion = 'gini')
model_train = model.fit(X_train , y_train)

"""# Making predictions"""

pred = model.predict(X_test)

"""# R square value"""

model.score(X_train , y_train)

"""# Accuracy of model"""

from sklearn.metrics import accuracy_score
accuracy_score(y_test , pred)

"""# Confusion Matrix"""

from sklearn.metrics import confusion_matrix
confusion_matrix(y_test , pred)